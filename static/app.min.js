(function(c){try{var k,g,b,d,f,p,m=0,u=100,q,n=c.getElementById("cms-graph"),r=c.getElementById("loader"),e=c.getElementsByTagName("noscript")[0],h=c.getElementById("psa"),x=c.getElementById("js-refresh"),l=function(a){r.style.display="block";c.getElementById("loader-content").style.display="none";(e=c.getElementById("loader-error")).style.display="block";a&&(e.innerHTML=a,a.replace("<br>"," "))},t=function(){0>=m?(m=45,y()):(setTimeout(t,1E3),x.textContent=10>--m?"0"+m:m)},w=function(){var a=new XMLHttpRequest;
a.open("GET","https://crowbar.steamdb.info/Gina",!0);a.onreadystatechange=function(){try{4===a.readyState&&(b=JSON.parse(a.responseText),b.success?(q=b.data,"Highcharts"in window&&v()):n.textContent="Failed to load graph data.")}catch(c){n.textContent="Failed to load graph data."}};a.ontimeout=function(){n.textContent="Request timed out, unable to render graph."};a.timeout=1E4;a.send()},y=function(){r.style.display="block";d=new XMLHttpRequest;d.open("GET","https://crowbar.steamdb.info/Barney",!0);
d.onreadystatechange=z;d.ontimeout=function(){l("Request timed out.<br>Reload the page manually.")};d.timeout=2E4;d.send()},z=function(){d=this;if(4===d.readyState){b=d.responseText;try{r.style.display="none";if(200!==d.status)return l("");if(null===b||"{"!==b[0])return l("Received invalid data.<br>Is something wrong with your network?");b=JSON.parse(b);if(!b.success)return l("");f=b.psa||"";p=Math.abs(Date.now()/1E3-b.time);300<p&&(f&&(f+="<hr>"),f+="Data appears to be "+(0|p/60)+" minutes old.",
3E3<p&&(f+=' <a href="http://time.is" target="_blank">Is your clock out of sync?</a>'));f?("block"!==h.style.display&&(h.style.display="block"),h.innerHTML!==f&&(h.innerHTML=f)):"none"!==h.style.display&&(h.innerHTML="",h.style.display="none");if(75>u&&75<=b.online&&"Notification"in window&&"granted"===window.Notification.permission){var a=new window.Notification("Steam is back online",{lang:"en",icon:"/static/logos/192px.png",body:b.online+"% of Steam servers are online, you could try logging in now."});
setTimeout(function(){a.close()},5E3)}u=b.online;b=b.services;for(k in b)if(e=c.getElementById(k))g=b[k],g.status&&(k="status "+g.status,e.className!==k&&(e.className=k)),g.time?e.innerHTML=g.title+' <span class="time" title="Time since last status change">('+A(g.time)+")</span>":e.textContent?e.textContent=g.title:e.innerText=g.title;t()}catch(C){l(""),console.debug("Status:",d.status,d.statusText),console.debug("Data:",b)}}},A=function(a){a=Date.now()-1E3*a;return 6E4>a?"<1m":36E5>a?Math.round(a/
6E4)+"m":864E5>a?Math.round(a/36E5)+"h":2592E6>a?"\u2248"+Math.round(a/864E5)+"d":31536E6>a?"\u2248"+Math.round(a/2592E6)+"m":"\u2248"+Math.round(a/31536E6)+"y"},B=function(){var a=c.getElementById("js-csgo-container"),b=c.getElementById("js-csgo-caret");window.localStorage.getItem("show_csgo")&&(a.classList.remove("closed"),b.classList.add("up"));c.getElementById("js-csgo-services").addEventListener("click",function(c){c.preventDefault();a.classList.contains("closed")?(a.classList.remove("closed"),
window.localStorage.setItem("show_csgo","1"),b.classList.add("up")):(a.classList.add("closed"),window.localStorage.removeItem("show_csgo"),b.classList.remove("up"))})},v=function(){if(q)if("Highcharts"in window){var a=new Date;a.setDate(a.getDate()-1);new window.Highcharts.Chart({s:{a:{c:!1,color:"#4384D8"}},f:{A:n,backgroundColor:"#282936",D:[5,0,0,0],style:{fontFamily:"'Open Sans', sans-serif"}},title:{text:null},g:{enabled:!1},i:{enabled:!1},w:{enabled:!1},B:{enabled:!1},navigator:{enabled:!1},
J:{enabled:!1},m:{enabled:!1},K:{type:"datetime",labels:{style:{color:"#9E9E9E"}},lineWidth:0,I:0},L:{j:"#3A3B47",title:{text:"Online CMs Today",style:{color:"#8A8DB7"}},labels:{format:"{value}%",style:{color:"#9E9E9E"}},C:!0,H:[0,25,50,75,100],min:0,max:100,b:!1,F:!1,h:!1},a:[{v:a.getTime(),u:3E4,data:q,o:{enabled:!1},G:{l:{enabled:!1}}}]});q=null}else n.innerHTML="Failed to load Highcharts.<br>Please unblock <b>cdnjs.cloudflare.com</b> for this to work."};e&&e.parentNode.removeChild(e);t();w();
setInterval(w,6E5);!("localStorage"in window)||"Notification"in window&&!window.Notification.permission||!Element.prototype.addEventListener?c.getElementById("old-browser").style.display="block":(B(),window.Notification&&"denied"!==window.Notification.permission&&window.Notification.requestPermission());window.RenderChart=v;"serviceWorker"in navigator&&navigator.serviceWorker.register("/service-worker.js",{scope:"./"});window.addEventListener("beforeinstallprompt",function(a){a.userChoice.then(function(a){"ga"in
window&&window.ga("send","event","Install Prompt","Outcome",a.outcome)})})}catch(a){l("Something broke.<br>"+(a.message||"Are you using an outdated browser?")),console.error(a)}})(document);
