(function(e){try{var k,g,b,c,f,p,l=0,v=100,q,m=e.getElementById("cms-graph"),r=e.getElementById("loader"),d=e.getElementsByTagName("noscript")[0],h=e.getElementById("psa"),x=e.getElementById("js-refresh"),n=function(a,b){r.style.display="block";e.getElementById("loader-content").style.display="none";(d=e.getElementById("loader-error")).style.display="block";a&&(d.innerHTML=a,a.replace("<br>"," "))},t=function(){0>=l?(l=45,y()):(setTimeout(t,1E3),x.textContent=10>--l?"0"+l:l)},y=function(){r.style.display=
"block";c=new XMLHttpRequest;c.open("GET","https://crowbar.steamdb.info/Barney",!0);c.onreadystatechange=z;c.ontimeout=function(){n("Request timed out.<br>Reload the page manually.")};c.timeout=2E4;c.send()},z=function(){c=this;if(4===c.readyState){b=c.responseText;try{r.style.display="none";if(200!==c.status)return n("","Status: "+c.status);if(null===b||"{"!==b[0])return n("Received invalid data.<br>Is something wrong with your network?");b=JSON.parse(b);f=b.psa||"";p=Math.abs(Date.now()/1E3-b.time);
300<p&&(f&&(f+="<hr>"),f+="Data appears to be "+(0|p/60)+" minutes old.",3E3<p&&(f+=' <a href="http://time.is" target="_blank">Is your clock out of sync?</a>'));f?("block"!==h.style.display&&(h.style.display="block"),h.innerHTML!==f&&(h.innerHTML=f)):"none"!==h.style.display&&(h.innerHTML="",h.style.display="none");if(75>v&&75<=b.online&&"Notification"in window&&"granted"===window.Notification.permission){var a=new window.Notification("Steam is back online",{lang:"en",icon:"/static/logos/192px.png",
body:b.online+"% of Steam servers are online, you could try logging in now."});setTimeout(function(){a.close()},5E3)}v=b.online;b=b.services;for(k in b)if(d=e.getElementById(k))g=b[k],g.status&&(k="status "+g.status,d.className!==k&&(d.className=k)),g.time?d.innerHTML=g.title+' <span class="time" title="Time since last status change">('+A(g.time)+")</span>":d.textContent?d.textContent=g.title:d.innerText=g.title;t()}catch(C){n(""),console.debug("Status:",c.status,c.statusText),console.debug("Data:",
b)}}},A=function(a){a=Date.now()-1E3*a;return 6E4>a?"<1m":36E5>a?Math.round(a/6E4)+"m":864E5>a?Math.round(a/36E5)+"h":2592E6>a?"\u2248"+Math.round(a/864E5)+"d":31536E6>a?"\u2248"+Math.round(a/2592E6)+"m":"\u2248"+Math.round(a/31536E6)+"y"},B=function(a){var b="show_"+a,c=e.getElementById("js-"+a+"-container"),d=e.getElementById("js-"+a+"-caret");window.localStorage.getItem(b)&&(c.classList.remove("closed"),d.classList.add("up"));e.getElementById("js-"+a+"-services").addEventListener("click",function(a){a.preventDefault();
c.classList.contains("closed")?(c.classList.remove("closed"),window.localStorage.setItem(b,"1"),d.classList.add("up")):(c.classList.add("closed"),window.localStorage.removeItem(b),d.classList.remove("up"))})},w=function(){if(q)if("Highcharts"in window){var a=new Date;a.setDate(a.getDate()-1);new window.Highcharts.Chart({plotOptions:{series:{animation:!1,color:"#4384D8"}},chart:{renderTo:m,backgroundColor:"#282936",spacing:[5,0,0,0],style:{fontFamily:"'Open Sans', sans-serif"}},title:{text:null},credits:{enabled:!1},
exporting:{enabled:!1},rangeSelector:{enabled:!1},scrollbar:{enabled:!1},navigator:{enabled:!1},tooltip:{enabled:!1},legend:{enabled:!1},xAxis:{type:"datetime",labels:{style:{color:"#9E9E9E"}},lineWidth:0,tickWidth:0},yAxis:{gridLineColor:"#3A3B47",title:{text:"Online CMs Today",style:{color:"#8A8DB7"}},labels:{format:"{value}%",style:{color:"#9E9E9E"}},showLastLabel:!0,tickPositions:[0,25,50,75,100],min:0,max:100,allowDecimals:!1,startOnTick:!1,endOnTick:!1},series:[{pointStart:a.getTime(),pointInterval:3E4,
data:q,marker:{enabled:!1},states:{hover:{enabled:!1}}}]});q=null}else m.innerHTML="Failed to load Highcharts.<br>Please unblock <b>cdnjs.cloudflare.com</b> for this to work."},u=function(){var a=new XMLHttpRequest;a.open("GET","https://crowbar.steamdb.info/Gina",!0);a.onreadystatechange=function(){try{4===a.readyState&&(b=JSON.parse(a.responseText),b.data?(q=b.data,"Highcharts"in window&&w()):m.textContent="Failed to load graph data: Failed to parse JSON.")}catch(c){m.textContent="Failed to load graph data: "+
(c.message||"Unknown error.")}};a.ontimeout=function(){m.textContent="Request timed out, unable to render graph."};a.timeout=1E4;a.send()};d&&d.parentNode.removeChild(d);t();u();setInterval(u,6E5);!("localStorage"in window)||"Notification"in window&&!window.Notification.permission||!Element.prototype.addEventListener?e.getElementById("old-browser").style.display="block":(B("csgo"),window.Notification&&"denied"!==window.Notification.permission&&window.Notification.requestPermission());window.RenderChart=
w;window.UpdateGraph=u;"serviceWorker"in navigator&&navigator.serviceWorker.register("/service-worker.js",{scope:"./"});window.addEventListener("beforeinstallprompt",function(a){a.userChoice.then(function(a){"ga"in window&&window.ga("send","event","Install Prompt","Outcome",a.outcome)})})}catch(a){n("Something broke.<br>"+(a.message||"Are you using an outdated browser?")),console.error(a)}})(document);
